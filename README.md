# é£æ‰‡å”å”çš„åšå®¢ | Smallfan's Blog

<div align="center">

[![Hexo](https://img.shields.io/badge/Hexo-8.0.0-blue.svg)](https://hexo.io)
[![Butterfly](https://img.shields.io/badge/Theme-Butterfly-brightgreen.svg)](https://github.com/jerryc127/hexo-theme-butterfly)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)
[![Node](https://img.shields.io/badge/Node-%3E%3D14.0.0-green.svg)](https://nodejs.org)

**A modern, feature-rich personal blog powered by Hexo and Butterfly theme**

[English](#english) | [ä¸­æ–‡](#ä¸­æ–‡)

</div>

---

## ä¸­æ–‡

### ğŸ“– é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªåŸºäº Hexo 8.0.0 å’Œ Butterfly ä¸»é¢˜æ„å»ºçš„ä¸ªäººæŠ€æœ¯åšå®¢ã€‚é‡‡ç”¨ç°ä»£åŒ–çš„å¡ç‰‡å¼è®¾è®¡ï¼Œæ”¯æŒæ·±è‰²æ¨¡å¼ã€éŸ³ä¹æ’­æ”¾å™¨ã€å“åº”å¼å¸ƒå±€ç­‰ä¸°å¯ŒåŠŸèƒ½ã€‚

ğŸŒ **ç½‘ç«™åœ°å€**: [https://smallfan.top](https://smallfan.top)

### âœ¨ ä¸»è¦ç‰¹æ€§

#### æ ¸å¿ƒåŠŸèƒ½
- ğŸ¨ **ç°ä»£åŒ–è®¾è®¡** - åŸºäº Butterfly ä¸»é¢˜çš„å¡ç‰‡å¼å“åº”å¼å¸ƒå±€
- ğŸŒ“ **æ·±è‰²æ¨¡å¼** - è‡ªåŠ¨/æ‰‹åŠ¨åˆ‡æ¢æ·±è‰²/æµ…è‰²ä¸»é¢˜
- ğŸ“± **ç§»åŠ¨é€‚é…** - å®Œç¾æ”¯æŒ PCã€å¹³æ¿ã€æ‰‹æœºç­‰å¤šç«¯è®¾å¤‡
- ğŸ” **æœ¬åœ°æœç´¢** - å¿«é€Ÿå…¨æ–‡æœç´¢æ–‡ç« å†…å®¹
- ğŸ“Š **æ•°å­¦å…¬å¼** - æ”¯æŒ LaTeX æ•°å­¦å…¬å¼æ¸²æŸ“
- ğŸ’¬ **è¯„è®ºç³»ç»Ÿ** - æ”¯æŒå¤šç§è¯„è®ºæ’ä»¶é›†æˆ

#### è‡ªå®šä¹‰åŠŸèƒ½
- ğŸµ **ä¸»é¡µéŸ³ä¹æ’­æ”¾å™¨**
  - ä»…åœ¨é¦–é¡µæ˜¾ç¤ºï¼Œä¸å½±å“å…¶ä»–é¡µé¢
  - å¯æ‹–æ‹½çš„æµ®åŠ¨æ’­æ”¾å™¨
  - æ”¯æŒæœ€å°åŒ–/å±•å¼€æ¨¡å¼åˆ‡æ¢
  - è·¨æ ‡ç­¾é¡µæ’­æ”¾æ§åˆ¶ï¼ˆé˜²æ­¢å¤šæ ‡ç­¾åŒæ—¶æ’­æ”¾ï¼‰
  - æ”¯æŒè¿œç¨‹ CDN å’Œæœ¬åœ°éŸ³é¢‘æ–‡ä»¶
  - è‡ªåŠ¨æ’­æ”¾å’Œç”¨æˆ·äº¤äº’è§¦å‘æ’­æ”¾
  - å®Œæ•´æ’­æ”¾æ§åˆ¶ï¼šæ’­æ”¾/æš‚åœã€ä¸Šä¸€æ›²/ä¸‹ä¸€æ›²ã€è¿›åº¦æ¡ã€éŸ³é‡æ§åˆ¶

- ğŸ”— **æ™ºèƒ½é“¾æ¥è¡Œä¸º**
  - é¦–é¡µæ‰€æœ‰é“¾æ¥åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€
  - ç½‘ç«™æ ‡é¢˜/Logo åœ¨å½“å‰æ ‡ç­¾é¡µæ‰“å¼€ï¼ˆä¿æŒéŸ³ä¹æ’­æ”¾ï¼‰
  - é”šç‚¹é“¾æ¥ä¿æŒåœ¨å½“å‰é¡µé¢

- ğŸ¨ **è‡ªå®šä¹‰æ ·å¼**
  - é¡µè„šç™½è‰²èƒŒæ™¯å’Œé»‘è‰²æ–‡å­—
  - è‡ªå®šä¹‰ CSS æ³¨å…¥ç³»ç»Ÿ

### ğŸ›  æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|
| **Hexo** | 8.0.0 | é™æ€ç«™ç‚¹ç”Ÿæˆå™¨ |
| **Node.js** | â‰¥14.0.0 | è¿è¡Œç¯å¢ƒ |
| **Butterfly Theme** | Latest | ç°ä»£åŒ–ä¸»é¢˜ |
| **Markdown** | - | æ–‡ç« æ ¼å¼ |
| **Stylus** | 3.0.1 | CSS é¢„å¤„ç†å™¨ |
| **Pug** | 3.0.0 | HTML æ¨¡æ¿å¼•æ“ |

### ğŸš€ å¿«é€Ÿå¼€å§‹

#### ç¯å¢ƒè¦æ±‚
- Node.js â‰¥ 14.0.0
- npm æˆ– yarn

#### å®‰è£…æ­¥éª¤

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd blog

# 2. å®‰è£…ä¾èµ–
npm install

# 3. å¯åŠ¨æœ¬åœ°å¼€å‘æœåŠ¡å™¨
npm run server
# è®¿é—® http://localhost:4000
```

#### å¸¸ç”¨å‘½ä»¤

```bash
# æ¸…ç†ç¼“å­˜å’Œç”Ÿæˆçš„æ–‡ä»¶
npm run clean

# ç”Ÿæˆé™æ€æ–‡ä»¶
npm run build

# å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ï¼ˆæ”¯æŒçƒ­é‡è½½ï¼‰
npm run server

# éƒ¨ç½²åˆ°è¿œç¨‹æœåŠ¡å™¨
npm run deploy

# åˆ›å»ºæ–°æ–‡ç« 
hexo new post "æ–‡ç« æ ‡é¢˜"

# åˆ›å»ºæ–°è‰ç¨¿
hexo new draft "è‰ç¨¿æ ‡é¢˜"

# å‘å¸ƒè‰ç¨¿
hexo publish "è‰ç¨¿æ ‡é¢˜"

# åˆ›å»ºæ–°é¡µé¢
hexo new page "é¡µé¢åç§°"
```

### ğŸ“ é¡¹ç›®ç»“æ„

```
blog/
â”œâ”€â”€ _config.yml                 # Hexo ä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ _config.butterfly.yml       # Butterfly ä¸»é¢˜é…ç½®
â”œâ”€â”€ package.json               # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ scaffolds/                 # æ–‡ç« æ¨¡æ¿
â”œâ”€â”€ source/                    # æºæ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ _posts/               # åšå®¢æ–‡ç« ï¼ˆMarkdownï¼‰
â”‚   â”œâ”€â”€ images/               # å›¾ç‰‡èµ„æº
â”‚   â”œâ”€â”€ css/                  # è‡ªå®šä¹‰æ ·å¼
â”‚   â”‚   â””â”€â”€ custom.css       # è‡ªå®šä¹‰ CSSï¼ˆæ’­æ”¾å™¨ã€é¡µè„šç­‰ï¼‰
â”‚   â”œâ”€â”€ js/                   # è‡ªå®šä¹‰è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ music-player.js  # éŸ³ä¹æ’­æ”¾å™¨é€»è¾‘
â”‚   â”‚   â””â”€â”€ homepage-links.js # é¦–é¡µé“¾æ¥è¡Œä¸º
â”‚   â””â”€â”€ music/                # éŸ³ä¹æ–‡ä»¶
â”‚       â””â”€â”€ playlist.json     # æ’­æ”¾åˆ—è¡¨é…ç½®
â”œâ”€â”€ themes/                    # ä¸»é¢˜ç›®å½•
â”‚   â””â”€â”€ butterfly/            # Butterfly ä¸»é¢˜
â””â”€â”€ public/                    # ç”Ÿæˆçš„é™æ€æ–‡ä»¶ï¼ˆæ„å»ºåï¼‰
```

### âš™ï¸ é…ç½®è¯´æ˜

#### Hexo æ ¸å¿ƒé…ç½® (`_config.yml`)
```yaml
# ç½‘ç«™åŸºæœ¬ä¿¡æ¯
title: é£æ‰‡å”å”
author: Smallfan
language: zh-CN
url: https://smallfan.top

# ä¸»é¢˜é…ç½®
theme: butterfly

# éƒ¨ç½²é…ç½®
deploy:
  type: git
  repo: <repository-url>
  branch: gh-pages
```

#### Butterfly ä¸»é¢˜é…ç½® (`_config.butterfly.yml`)
- å¤–è§‚è®¾ç½®ï¼ˆé¢œè‰²ã€å¸ƒå±€ã€å­—ä½“ï¼‰
- åŠŸèƒ½å¼€å…³ï¼ˆæ·±è‰²æ¨¡å¼ã€æœç´¢ã€è¯„è®ºï¼‰
- ç¤¾äº¤é“¾æ¥å’Œå›¾æ ‡
- ä»£ç é«˜äº®ä¸»é¢˜
- è‡ªå®šä¹‰è„šæœ¬æ³¨å…¥

#### éŸ³ä¹æ’­æ”¾å™¨é…ç½® (`source/music/playlist.json`)
```json
{
  "files": [
    "https://cdn.example.com/song1.mp3",
    "local-song.mp3"
  ]
}
```

### ğŸµ éŸ³ä¹æ’­æ”¾å™¨ä½¿ç”¨

1. **æ·»åŠ éŸ³ä¹æ–‡ä»¶**
   - è¿œç¨‹æ–‡ä»¶ï¼šç›´æ¥åœ¨ `playlist.json` ä¸­æ·»åŠ  CDN URL
   - æœ¬åœ°æ–‡ä»¶ï¼šå°†éŸ³é¢‘æ–‡ä»¶æ”¾å…¥ `source/music/` ç›®å½•

2. **é…ç½®æ’­æ”¾åˆ—è¡¨**
   - ç¼–è¾‘ `source/music/playlist.json`
   - éŸ³ä¹æŒ‰ JSON æ•°ç»„é¡ºåºæ’­æ”¾

3. **æ’­æ”¾æ§åˆ¶**
   - æ‹–æ‹½æ’­æ”¾å™¨åˆ°ä»»æ„ä½ç½®
   - ç‚¹å‡»æœ€å°åŒ–/å±•å¼€æŒ‰é’®åˆ‡æ¢æ¨¡å¼
   - ä½¿ç”¨è¿›åº¦æ¡è·³è½¬æ’­æ”¾ä½ç½®
   - è°ƒæ•´éŸ³é‡æ»‘å—æ§åˆ¶éŸ³é‡

### ğŸŒ éƒ¨ç½²

#### GitHub Pages

```bash
# 1. é…ç½® _config.yml ä¸­çš„ deploy éƒ¨åˆ†
deploy:
  type: git
  repo: https://github.com/username/username.github.io.git
  branch: gh-pages

# 2. å®‰è£…éƒ¨ç½²æ’ä»¶ï¼ˆå·²å®‰è£…ï¼‰
npm install hexo-deployer-git --save

# 3. ç”Ÿæˆå¹¶éƒ¨ç½²
npm run clean
npm run build
npm run deploy
```

#### å…¶ä»–å¹³å°
- **Vercel**: è¿æ¥ GitHub ä»“åº“ï¼Œè®¾ç½®æ„å»ºå‘½ä»¤ä¸º `npm run build`ï¼Œè¾“å‡ºç›®å½•ä¸º `public`
- **Netlify**: åŒ Vercel é…ç½®
- **VPS**: ä½¿ç”¨ rsync æˆ– scp å°† `public/` ç›®å½•ä¸Šä¼ åˆ°æœåŠ¡å™¨

### ğŸ¨ è‡ªå®šä¹‰å¼€å‘

#### æ·»åŠ è‡ªå®šä¹‰ CSS
1. åœ¨ `source/css/custom.css` ä¸­æ·»åŠ æ ·å¼
2. åœ¨ `_config.butterfly.yml` çš„ `inject.head` ä¸­å¼•å…¥

#### æ·»åŠ è‡ªå®šä¹‰ JavaScript
1. åœ¨ `source/js/` ä¸­åˆ›å»º JS æ–‡ä»¶
2. åœ¨ `_config.butterfly.yml` çš„ `inject.bottom` ä¸­å¼•å…¥

#### ä¿®æ”¹ä¸»é¢˜
- å»ºè®®ä½¿ç”¨ä¸»é¢˜é…ç½®æ–‡ä»¶ `_config.butterfly.yml` è€Œéç›´æ¥ä¿®æ”¹ä¸»é¢˜æ–‡ä»¶
- æ·±åº¦å®šåˆ¶å¯ä¿®æ”¹ `themes/butterfly/` ä¸­çš„æ–‡ä»¶

### ğŸ“ å†…å®¹ç®¡ç†

#### æ–‡ç«  Front Matter
```yaml
---
title: æ–‡ç« æ ‡é¢˜
date: 2024-01-01 12:00:00
tags: [æ ‡ç­¾1, æ ‡ç­¾2]
categories: åˆ†ç±»
cover: /images/cover.jpg
description: æ–‡ç« æè¿°
---
```

#### æ”¯æŒçš„åŠŸèƒ½
- ä»£ç é«˜äº®
- æ•°å­¦å…¬å¼ï¼ˆLaTeXï¼‰
- å›¾ç‰‡ç¯ç®±
- ç›®å½•ï¼ˆTOCï¼‰
- æ–‡ç« åŠ å¯†
- è¯„è®ºç³»ç»Ÿ

### ğŸ”§ æ•…éšœæ’é™¤

**é—®é¢˜ï¼šæœ¬åœ°æœåŠ¡å™¨æ— æ³•å¯åŠ¨**
```bash
# æ¸…ç†ç¼“å­˜å¹¶é‡æ–°å¯åŠ¨
npm run clean
npm run server
```

**é—®é¢˜ï¼šéŸ³ä¹æ’­æ”¾å™¨ä¸æ˜¾ç¤º**
- æ£€æŸ¥ `playlist.json` æ ¼å¼æ˜¯å¦æ­£ç¡®
- ç¡®è®¤ `music-player.js` å·²åœ¨ `_config.butterfly.yml` ä¸­æ³¨å…¥
- æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯

**é—®é¢˜ï¼šæ„å»ºå¤±è´¥**
```bash
# åˆ é™¤ node_modules é‡æ–°å®‰è£…
rm -rf node_modules package-lock.json
npm install
```

### ğŸ“„ è®¸å¯è¯

MIT License

### ğŸ™ è‡´è°¢

- [Hexo](https://hexo.io/) - é™æ€ç«™ç‚¹ç”Ÿæˆå™¨
- [Butterfly Theme](https://github.com/jerryc127/hexo-theme-butterfly) - ä¼˜ç§€çš„ Hexo ä¸»é¢˜
- æ‰€æœ‰è´¡çŒ®è€…å’Œå¼€æºç¤¾åŒº

---

## English

### ğŸ“– Project Overview

A modern personal tech blog built with Hexo 8.0.0 and Butterfly theme, featuring a contemporary card-based design with dark mode, music player, responsive layout, and rich functionality.

ğŸŒ **Website**: [https://smallfan.top](https://smallfan.top)

### âœ¨ Key Features

#### Core Features
- ğŸ¨ **Modern Design** - Card-based responsive layout with Butterfly theme
- ğŸŒ“ **Dark Mode** - Auto/manual dark/light theme switching
- ğŸ“± **Mobile Friendly** - Perfect support for PC, tablet, and mobile devices
- ğŸ” **Local Search** - Fast full-text article search
- ğŸ“Š **Math Support** - LaTeX math formula rendering
- ğŸ’¬ **Comment System** - Multiple comment plugin integration

#### Custom Features
- ğŸµ **Homepage Music Player**
  - Displays only on homepage
  - Draggable floating player
  - Minimize/expand mode toggle
  - Cross-tab playback control (prevents multi-tab playback)
  - Supports remote CDN and local audio files
  - Auto-play and user interaction triggered playback
  - Full playback controls: play/pause, prev/next, progress bar, volume control

- ğŸ”— **Smart Link Behavior**
  - All homepage links open in new tabs
  - Site title/logo opens in current tab (preserves music playback)
  - Anchor links stay on current page

- ğŸ¨ **Custom Styling**
  - White footer background with black text
  - Custom CSS injection system

### ğŸ›  Tech Stack

| Technology | Version | Description |
|------------|---------|-------------|
| **Hexo** | 8.0.0 | Static site generator |
| **Node.js** | â‰¥14.0.0 | Runtime environment |
| **Butterfly Theme** | Latest | Modern theme |
| **Markdown** | - | Content format |
| **Stylus** | 3.0.1 | CSS preprocessor |
| **Pug** | 3.0.0 | HTML template engine |

### ğŸš€ Quick Start

#### Requirements
- Node.js â‰¥ 14.0.0
- npm or yarn

#### Installation

```bash
# 1. Clone the repository
git clone <repository-url>
cd blog

# 2. Install dependencies
npm install

# 3. Start local dev server
npm run server
# Visit http://localhost:4000
```

#### Common Commands

```bash
# Clean cache and generated files
npm run clean

# Generate static files
npm run build

# Start local server (with hot reload)
npm run server

# Deploy to remote server
npm run deploy

# Create new post
hexo new post "Post Title"

# Create new draft
hexo new draft "Draft Title"

# Publish draft
hexo publish "draft-title"

# Create new page
hexo new page "page-name"
```

### ğŸ“ Project Structure

```
blog/
â”œâ”€â”€ _config.yml                 # Main Hexo configuration
â”œâ”€â”€ _config.butterfly.yml       # Butterfly theme config
â”œâ”€â”€ package.json               # Project dependencies
â”œâ”€â”€ scaffolds/                 # Post templates
â”œâ”€â”€ source/                    # Source files
â”‚   â”œâ”€â”€ _posts/               # Blog posts (Markdown)
â”‚   â”œâ”€â”€ images/               # Image assets
â”‚   â”œâ”€â”€ css/                  # Custom styles
â”‚   â”‚   â””â”€â”€ custom.css       # Custom CSS (player, footer, etc.)
â”‚   â”œâ”€â”€ js/                   # Custom scripts
â”‚   â”‚   â”œâ”€â”€ music-player.js  # Music player logic
â”‚   â”‚   â””â”€â”€ homepage-links.js # Homepage link behavior
â”‚   â””â”€â”€ music/                # Music files
â”‚       â””â”€â”€ playlist.json     # Playlist configuration
â”œâ”€â”€ themes/                    # Themes directory
â”‚   â””â”€â”€ butterfly/            # Butterfly theme
â””â”€â”€ public/                    # Generated static files (after build)
```

### âš™ï¸ Configuration

#### Hexo Core Config (`_config.yml`)
```yaml
# Site info
title: Smallfan's Blog
author: Smallfan
language: zh-CN
url: https://smallfan.top

# Theme
theme: butterfly

# Deployment
deploy:
  type: git
  repo: <repository-url>
  branch: gh-pages
```

#### Butterfly Theme Config (`_config.butterfly.yml`)
- Appearance settings (colors, layout, fonts)
- Feature toggles (dark mode, search, comments)
- Social links and icons
- Code highlighting themes
- Custom script injection

#### Music Player Config (`source/music/playlist.json`)
```json
{
  "files": [
    "https://cdn.example.com/song1.mp3",
    "local-song.mp3"
  ]
}
```

### ğŸµ Music Player Usage

1. **Add Music Files**
   - Remote files: Add CDN URL directly in `playlist.json`
   - Local files: Place audio files in `source/music/` directory

2. **Configure Playlist**
   - Edit `source/music/playlist.json`
   - Music plays in JSON array order

3. **Playback Controls**
   - Drag player to any position
   - Click minimize/expand button to toggle mode
   - Use progress bar to seek playback position
   - Adjust volume slider to control volume

### ğŸŒ Deployment

#### GitHub Pages

```bash
# 1. Configure deploy section in _config.yml
deploy:
  type: git
  repo: https://github.com/username/username.github.io.git
  branch: gh-pages

# 2. Install deploy plugin (already installed)
npm install hexo-deployer-git --save

# 3. Generate and deploy
npm run clean
npm run build
npm run deploy
```

#### Other Platforms
- **Vercel**: Connect GitHub repo, set build command to `npm run build`, output dir to `public`
- **Netlify**: Same as Vercel config
- **VPS**: Use rsync or scp to upload `public/` directory to server

### ğŸ¨ Custom Development

#### Add Custom CSS
1. Add styles to `source/css/custom.css`
2. Include in `inject.head` of `_config.butterfly.yml`

#### Add Custom JavaScript
1. Create JS file in `source/js/`
2. Include in `inject.bottom` of `_config.butterfly.yml`

#### Modify Theme
- Recommended: Use theme config file `_config.butterfly.yml` instead of modifying theme files directly
- Deep customization: Modify files in `themes/butterfly/`

### ğŸ“ Content Management

#### Post Front Matter
```yaml
---
title: Post Title
date: 2024-01-01 12:00:00
tags: [tag1, tag2]
categories: Category
cover: /images/cover.jpg
description: Post description
---
```

#### Supported Features
- Code highlighting
- Math formulas (LaTeX)
- Image lightbox
- Table of contents (TOC)
- Post encryption
- Comment system

### ğŸ”§ Troubleshooting

**Issue: Local server won't start**
```bash
# Clean cache and restart
npm run clean
npm run server
```

**Issue: Music player not showing**
- Check `playlist.json` format
- Verify `music-player.js` is injected in `_config.butterfly.yml`
- Check browser console for errors

**Issue: Build fails**
```bash
# Remove node_modules and reinstall
rm -rf node_modules package-lock.json
npm install
```

### ğŸ“„ License

MIT License

### ğŸ™ Acknowledgments

- [Hexo](https://hexo.io/) - Static site generator
- [Butterfly Theme](https://github.com/jerryc127/hexo-theme-butterfly) - Excellent Hexo theme
- All contributors and open source community

---

<div align="center">

**Made with â¤ï¸ by Smallfan**

If you find this project helpful, please consider giving it a â­ï¸

</div>
